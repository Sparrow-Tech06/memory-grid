<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Memory Grid Game</title>

<!-- Bootstrap 5 CDN -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{
  background:#f5f7ff;
  font-family:system-ui;
}

.game-card{
  border:1px solid #e1e5ff;
  border-radius:16px;
}

.grid{
  display:grid;
  gap:10px;
}

.cell{
  background:#eef1ff;
  border-radius:12px;
  aspect-ratio:1;
  transition:.25s;
}

.cell.active{ background:#6c9cff; }
.cell.correct{ background:#6fdcbf; }
.cell.wrong{ background:#ff9a9a; }

/* Overlay popup */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.4);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:1000;
}

.popup{
  background:#fff;
  border-radius:16px;
  padding:24px;
  width:280px;
  text-align:center;
  border:1px solid #ddd;
}

.timer{
  font-size:14px;
  color:#666;
}
</style>
</head>

<body>

<div id="app" class="container min-vh-100 d-flex align-items-center justify-content-center">

  <div class="game-card bg-white p-3 w-100" style="max-width:360px">

    <!-- Header -->
    <div class="d-flex justify-content-between mb-2">
      <span class="badge border text-dark">Level: {{ level }}</span>
      <span class="badge border text-dark">Moves: {{ moves }}</span>
    </div>

    <div class="text-center timer mb-2" v-if="!canClick">
      Memorize... game starts soon
    </div>

    <!-- Grid -->
    <div class="grid my-3"
         :style="{gridTemplateColumns:`repeat(${gridCols},1fr)`}">
      <div v-for="(c,i) in cells"
           :key="i"
           class="cell"
           :class="cellClass(i)"
           @click="selectCell(i)">
      </div>
    </div>

    <button class="btn btn-primary w-100" @click="startLevel">
      Start
    </button>
  </div>

  <!-- Custom Popup -->
  <div v-if="popup.show" class="overlay">
    <div class="popup">
      <h5 class="mb-2">{{ popup.title }}</h5>
      <p class="text-muted small">{{ popup.msg }}</p>
      <button class="btn btn-primary w-100 mt-2" @click="popupAction">
        Continue
      </button>
    </div>
  </div>

</div>

<!-- Vue 3 CDN -->
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

<script>
Vue.createApp({
  data(){
    return{
      level:1,
      moves:0,
      pattern:[],
      userPick:[],
      canClick:false,
      popup:{show:false,title:'',msg:'',success:false}
    }
  },
  computed:{
    cells(){
      // Level 1-2 = 2 cells, every 2 levels +1 cell
      return 2 + Math.floor((this.level - 1) / 2);
    },
    gridCols(){
      return Math.ceil(Math.sqrt(this.cells));
    }
  },
  methods:{
    startLevel(){
      this.moves=0;
      this.userPick=[];
      this.pattern=[];
      this.canClick=false;

      // generate pattern
      while(this.pattern.length < Math.min(2,this.cells)){
        let r = Math.floor(Math.random()*this.cells);
        if(!this.pattern.includes(r)) this.pattern.push(r);
      }

      this.$nextTick(()=>{
        this.blinkPattern();
      });
    },

    // STEP 1: blink pattern
    blinkPattern(){
      const nodes = document.querySelectorAll('.cell');
      this.pattern.forEach(i=> nodes[i]?.classList.add('active'));

      setTimeout(()=>{
        this.pattern.forEach(i=> nodes[i]?.classList.remove('active'));
        this.waitBeforePlay();
      },800);
    },

    // STEP 2: wait 3 seconds
    waitBeforePlay(){
      setTimeout(()=>{
        this.canClick=true;
      },3000);
    },

    // STEP 3: user interaction
    selectCell(i){
      if(!this.canClick || this.userPick.includes(i)) return;

      this.moves++;
      this.userPick.push(i);

      if(!this.pattern.includes(i)){
        this.canClick=false;
        setTimeout(()=>{
          this.popup={
            show:true,
            title:"Try Again âŒ",
            msg:"Focus and try once more",
            success:false
          };
        },600);
        return;
      }

      if(this.userPick.length === this.pattern.length){
        this.canClick=false;
        setTimeout(()=>{
          this.popup={
            show:true,
            title:"Well Done ðŸŽ‰",
            msg:"Next level unlocked",
            success:true
          };
        },600);
      }
    },

    popupAction(){
      this.popup.show=false;
      if(this.popup.success){
        this.level++;
      }
      this.startLevel();
    },

    cellClass(i){
      if(this.userPick.includes(i)){
        return this.pattern.includes(i) ? 'correct' : 'wrong';
      }
      return '';
    }
  }
}).mount('#app');
</script>

</body>
</html>
