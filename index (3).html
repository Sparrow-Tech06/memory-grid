<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Memory Grid Game</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

<style>
:root {
  --primary-dark: #34495e; /* Image jaisa dark color */
  --bg-light: #ffffff;
}

body { 
  background: var(--bg-light); 
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  color: var(--primary-dark);
}

/* UI Elements from Image */
.dark-mode-toggle {
  position: absolute; top: 20px; right: 20px;
  background: var(--primary-dark); color: white;
  width: 45px; height: 45px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
}

.grid { 
  display: grid; gap: 12px; margin: 40px auto; 
  max-width: 300px;
}

.cell {
  background: transparent;
  border: 1.5px solid #000;
  border-radius: 12px;
  aspect-ratio: 1;
  cursor: pointer;
  transition: all 0.2s;
}

/* Colors matching the image */
.cell.active { background: var(--primary-dark); border-color: var(--primary-dark); }
.cell.correct { background: var(--primary-dark); border-color: var(--primary-dark); }
.cell.wrong { background: #ff6b6b; border-color: #ff6b6b; }

.btn-start {
  border: 1.5px solid #000;
  background: white;
  color: black;
  border-radius: 50px;
  padding: 12px 60px;
  font-size: 1.1rem;
  transition: 0.3s;
}

.btn-start:hover { background: #f0f0f0; border-color: #000; }

.bottom-icons {
  position: absolute; bottom: 40px; left: 0; right: 0;
  display: flex; justify-content: space-around;
  padding: 0 40px; font-size: 1.5rem;
}

.back-btn {
  position: absolute; top: 20px; left: 20px;
  font-size: 1.2rem; cursor: pointer;
}

.overlay {
  position: fixed; inset: 0; background: rgba(255,255,255,0.9);
  display: flex; align-items: center; justify-content: center; z-index: 1000;
}
</style>
</head>

<body>

<div id="app" class="container min-vh-100 d-flex flex-column align-items-center justify-content-center">

  <div v-if="screen === 'menu'" class="w-100 text-center animate__animated animate__fadeIn">
    <div class="dark-mode-toggle"><i class="bi bi-moon-fill"></i></div>
    
    <div class="grid" style="grid-template-columns: repeat(3, 1fr);">
      <div v-for="i in 9" :key="i" class="cell" :class="{'active': [3,5,6].includes(i)}"></div>
    </div>

    <button class="btn btn-start mt-4" @click="goToGame">Start Game</button>

    <div class="bottom-icons text-dark">
      <i class="bi bi-gear"></i>
      <i class="bi bi-list-ul"></i>
      <i class="bi bi-info-circle"></i>
    </div>
  </div>

  <div v-if="screen === 'game'" class="w-100 text-center animate__animated animate__fadeIn">
    <div class="back-btn" @click="screen = 'menu'"><i class="bi bi-chevron-left"></i> Menu</div>
    
    <div class="d-flex justify-content-between w-100 px-4 mb-2" style="max-width: 400px;">
        <span class="fw-bold">Level: {{ level }}</span>
        <span class="text-muted">High Score: {{ highScore }}</span>
    </div>

    <div class="timer-zone mb-3" style="height: 25px;">
        <span v-if="isCountingDown" class="text-danger fw-bold">Ready in: {{ countdown }}</span>
        <span v-else-if="canClick" class="text-success fw-bold">GO!</span>
    </div>

    <div class="grid" :style="{gridTemplateColumns:`repeat(${gridCols},1fr)`}">
      <div v-for="(c,i) in totalCells"
           :key="i"
           class="cell animate__animated"
           :class="cellClass(i)"
           @click="selectCell(i)">
      </div>
    </div>

    <button class="btn btn-start" @click="startLevel">
      {{ gameStarted ? 'Retry Level' : 'Tap to Start' }}
    </button>
  </div>

  <div v-if="popup.show" class="overlay">
    <div class="text-center p-4">
      <h2 class="mb-3">{{ popup.title }}</h2>
      <button class="btn btn-start" @click="popupAction">Continue</button>
    </div>
  </div>

</div>

<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

<script>
const { createApp } = Vue;

createApp({
  data(){
    return{
      screen: 'menu', // menu or game
      level: 1,
      highScore: localStorage.getItem('memoryHighScore') || 0,
      pattern: [],
      userPick: [],
      canClick: false,
      gameStarted: false,
      isCountingDown: false,
      countdown: 3,
      popup: { show: false, title: '', success: false }
    }
  },
  computed:{
    totalCells(){
      return Math.pow(Math.floor(this.level / 4) + 3, 2); // Starts with 3x3 like image
    },
    gridCols(){
      return Math.sqrt(this.totalCells);
    }
  },
  methods:{
    goToGame() {
        this.screen = 'game';
        this.level = 1;
        this.gameStarted = false;
    },
    startLevel(){
      this.gameStarted = true;
      this.userPick = [];
      this.pattern = [];
      this.canClick = false;
      this.isCountingDown = false;
      this.popup.show = false;

      // Generate Pattern
      const patternSize = 2 + Math.floor(this.level / 2);
      while(this.pattern.length < patternSize){
        let r = Math.floor(Math.random() * this.totalCells);
        if(!this.pattern.includes(r)) this.pattern.push(r);
      }

      // Blink then Countdown
      setTimeout(() => { this.startCountdown(); }, 1000);
    },
    startCountdown(){
      this.isCountingDown = true;
      this.countdown = 3;
      let timer = setInterval(() => {
        this.countdown--;
        if(this.countdown <= 0){
          clearInterval(timer);
          this.isCountingDown = false;
          this.canClick = true;
        }
      }, 1000);
    },
    selectCell(i){
      if(!this.canClick || this.userPick.includes(i)) return;
      this.userPick.push(i);
      if(!this.pattern.includes(i)){
        this.canClick = false;
        setTimeout(() => { this.popup = { show: true, title: "Game Over âŒ", success: false }; }, 400);
        return;
      }
      if(this.userPick.length === this.pattern.length){
        this.canClick = false;
        if(this.level > this.highScore) {
            this.highScore = this.level;
            localStorage.setItem('memoryHighScore', this.level);
        }
        setTimeout(() => { this.popup = { show: true, title: "Level Up! ðŸŒŸ", success: true }; }, 400);
      }
    },
    popupAction(){
      this.popup.show = false;
      if(this.popup.success) this.level++;
      else this.level = 1;
      this.startLevel();
    },
    cellClass(i){
      if(!this.gameStarted && this.screen === 'game') return '';
      if(!this.canClick && !this.isCountingDown && this.pattern.includes(i)) return 'active';
      if(this.userPick.includes(i)){
        return this.pattern.includes(i) ? 'correct' : 'wrong';
      }
      return '';
    }
  }
}).mount('#app');
</script>
</body>
</html>
